{% extends "base.html" %}
{% load humanize %}
{% block head_title %}{{ item.title }} - {{ request.site.siteinfo.title }}{% endblock %}

{% block content %}

<!--Main layout-->
<main>
  <div id="item" class="container dark-grey-text">

    <nav id="category-menu" class="navbar navbar-expand-lg navbar-dark">

      <!-- Navbar brand -->
      <!-- <span class="navbar-brand">Categories:</span> -->

      <!-- Collapse button -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
        aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Collapsible content -->
      <div class="collapse navbar-collapse" id="basicExampleNav">

        <!-- Links -->
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">All
              <span class="sr-only">(current)</span>
            </a>
          </li>
          {% for value, category in category_choices %}
          <li class="nav-item">
            <a class="nav-link" href="#">{{ category }}</a>
          </li>
          {% endfor %}

        </ul>
        <!-- Links -->

        <form class="form-inline">
          <div class="md-form my-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
          </div>
        </form>
      </div>
      <!-- Collapsible content -->

    </nav>
    <!--/.Navbar-->


    <!--Grid row-->
    <div class="feature">

      <!--Grid column-->
      <div class="">

        {% if item.image %}
        <img src="{{ item.image_medium.url }}" class="card-img-top" alt="">
        {% endif %}

      </div>
      <!--Grid column-->

      <!--Grid column-->
      <div class="">

        <!--Content-->
        <div class="item-detail">

          <div>

            <a href="#">
              <span class="badge {{ item.get_category_display }}-color mr-1">{{ item.get_category_display }}</span>
            </a>

            <h2>
              {{ item.title }}
              {% if already_favorite %}
              <a href="{{ item.get_remove_from_fav_items_url }}">
                <i class="fas fa-heart only-mobile"></i>
              </a>
              {% else %}
              <a href="{{ item.get_add_to_fav_items_url }}">
                <i class="far fa-heart only-mobile"></i>
              </a>
              {% endif %}
            </h2>

            <p class="lead">
              {% if item.discount_price %}
              <span class="mr-1">
                <small><del>¥{{ item.price | intcomma }}</del></small>
              </span>
              <span>¥{{ item.discount_price | intcomma }}</span>
              {% else %}
              <span>¥{{ item.price | intcomma }}</span>
              {% endif %}
            </p>
            <p class="mt-3 mb-3">{{ item.description | safe | linebreaks }} </p>

            {% if item.stock == 0 %}
            <p class="stock text-danger">在庫がありません</p>
            {% elif item.stock %}
            <p class="stock">在庫数: {{ item.stock }}</p>
            {% endif %}

            <a href="{{ item.get_add_to_cart_url }}" class="btn btn-main btn-md" id="add-to-cart">カートに入れる
              <!-- <a href="{% url 'core:add-to-cart' item.slug %}" class=" btn btn-primary btn-md my-0 p">Add to cart -->
              <i class="fas fa-shopping-cart ml-1"></i>
            </a>
            <!-- <a href="{{ item.get_remove_from_cart_url }}" class=" btn btn-danger btn-md my-0 p">Remove from cart
          </a> -->

            <div class="mt-2 mobile-off">
              {% if already_favorite %}
              <a href="{{ item.get_remove_from_fav_items_url }}" class="btn btn-outline-second btn-sm"
                id="add-to-cart">お気に入りから外す</a>
              {% else %}
              <a href="{{ item.get_add_to_fav_items_url }}" class="btn btn-outline-main btn-sm"
                id="add-to-cart">お気に入りに追加</a>
              {% endif %}
            </div>

            <!-- <form class="d-flex justify-content-left">
          <input type="number" value="1" aria-label="Search" class="form-control" style="width: 100px">
          <button class="btn btn-primary btn-md my-0 p" type="submit">Add to cart
            <i class="fas fa-shopping-cart ml-1"></i>
          </button>
          </form> -->

          </div>

        </div>
        <!--Content-->

      </div>
      <!--Grid column-->

      {% if user.is_staff %}
      <div class="mt-3 flex-buttons">
        <a href="{% url 'core:item-update' item.slug %}" class="btn btn-outline-main btn-md">編集する</a>
        <a href="{% url 'core:item-delete' item.slug %}" class=" btn btn-outline-danger btn-md">削除する</a>
      </div>
      <div></div>
      <div>
        <a href="{% url 'core:item-create' %}" class="btn btn-main btn-md" id="btn-add-item">商品を追加する</a>
      </div>
      {% endif %}

    </div>
    <!--Grid row-->


    <hr>

    <div class="mt-5">
      <h6 class="mb-3">あなたにおすすめ</h6>
      <div class="other-items">
        {% for item in other_items %}
        <div class=" item {% if item.featured %}featured-item{% endif %}">
          {% if item.image %}
          <a href="{{ item.get_absolute_url }}">
            <img src="{{ item.image_medium.url }}" class="card-img-top" alt="">
          </a>
          {% endif %}
          <!-- <img class="item-photo" src="https://source.unsplash.com/random/300x300?v=2"> -->
          <div class="">
            <small>{{ item.get_category_display }}</small>
            <a href="{{ item.get_absolute_url }}">
              <h3>{{ item.title }}</h3>
            </a>
            <p class="">¥
              {% if item.discount_price %}
              {{ item.discount_price | intcomma }}
              {% else %}
              {{ item.price | intcomma }}
              {% endif %}
            </p>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <!-- <div class="mt-5">
      <h3>You might also like...</h3>
      <div class="other-items">
        {% for item in other_items %}
        <div>
          {% if item.image %}
          <a href="{{ item.get_absolute_url }}">
            <img src="{{ item.image.url }}" class="card-img-top" alt="">
          </a>
          {% endif %}
          <a href="{{ item.get_absolute_url }}">
            {{ item.title }}
          </a>
        </div>
        {% endfor %}
      </div> -->

  </div>


  </div>
  <!-- container -->
</main>
<!--Main layout-->

{% endblock content %}